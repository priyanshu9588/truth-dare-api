{
  "scan_timestamp": "2025-09-03T17:30:00Z",
  "status": "Pass",
  "api_name": "Truth and Dare API",
  "version": "0.1.0",
  "technology_stack": {
    "framework": "FastAPI",
    "language": "Python 3.13",
    "testing": "pytest",
    "validation": "Pydantic"
  },
  "security_scan_results": {
    "semgrep_scan": {
      "status": "PASSED",
      "critical_issues": 0,
      "high_issues": 0,
      "medium_issues": 0,
      "low_issues": 0,
      "files_scanned": [
        "app/main.py",
        "app/core/config.py",
        "app/core/exceptions.py",
        "app/utils/data_loader.py",
        "app/routes/truth.py",
        "app/routes/dare.py",
        "app/routes/game.py"
      ],
      "scan_notes": "No security vulnerabilities detected by Semgrep security rules"
    },
    "manual_security_review": {
      "status": "PASSED",
      "findings": []
    }
  },
  "fastapi_security_checklist": {
    "input_validation": {
      "status": "SECURE",
      "details": "Pydantic models provide comprehensive input validation with proper type checking and field validation"
    },
    "path_parameter_validation": {
      "status": "SECURE", 
      "details": "Path parameters use regex validation (^[a-zA-Z]+$) to prevent injection attacks"
    },
    "cors_configuration": {
      "status": "SECURE",
      "details": "CORS properly configured with specific allowed origins (localhost:3000, localhost:8080), credentials enabled"
    },
    "error_handling": {
      "status": "SECURE",
      "details": "Comprehensive error handling with custom exception classes, no stack traces exposed to users"
    },
    "data_sanitization": {
      "status": "SECURE",
      "details": "JSON data loaded with proper encoding (utf-8), path validation using pathlib"
    },
    "http_status_codes": {
      "status": "SECURE",
      "details": "Proper HTTP status codes used (200, 404, 422, 500) with consistent error responses"
    },
    "dependency_injection": {
      "status": "SECURE",
      "details": "FastAPI dependency injection used properly without security concerns"
    },
    "logging": {
      "status": "SECURE",
      "details": "Structured logging implemented without exposing sensitive information"
    }
  },
  "test_coverage": {
    "overall_coverage": "84.49%",
    "total_tests": 71,
    "test_status": "PASSED",
    "test_categories": {
      "unit_tests": "67 tests",
      "integration_tests": "4 tests", 
      "error_handling_tests": "15 tests",
      "api_endpoint_tests": "22 tests"
    }
  },
  "security_recommendations": {
    "immediate_actions": [],
    "future_enhancements": [
      "Add rate limiting for production deployment",
      "Implement API key authentication if needed for production",
      "Add request/response logging for audit trails",
      "Consider adding security headers middleware (HSTS, CSP, etc.)",
      "Update Pydantic validators to V2 style to eliminate deprecation warnings"
    ]
  },
  "deployment_security": {
    "production_readiness": "GOOD",
    "security_headers": "NOT_IMPLEMENTED",
    "rate_limiting": "NOT_IMPLEMENTED", 
    "authentication": "NOT_REQUIRED",
    "https_enforcement": "CONFIGURATION_DEPENDENT"
  },
  "data_protection": {
    "sensitive_data_handling": "N/A - No sensitive data processed",
    "file_access_security": "SECURE - Proper path validation and encoding",
    "data_validation": "SECURE - Comprehensive Pydantic validation"
  },
  "compliance_notes": {
    "owasp_top_10": "Compliant - No identified vulnerabilities",
    "security_best_practices": "Follows FastAPI and Python security best practices"
  }
}